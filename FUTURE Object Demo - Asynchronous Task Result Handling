/**
 * =============================================================================
 * FUTURE Object Demo - Asynchronous Task Result Handling
 * =============================================================================
 * 
 * FUTURE INTERFACE: Represents the result of an async task
 * Key Methods:
 * âœ… isDone()     - Check if computation completed
 * âœ… get()        - Block & get result (or wait forever)
 * âœ… get(timeout) - Block with timeout
 * âœ… isCancelled()- Check if task was cancelled
 * âœ… cancel()     - Attempt to cancel task
 * 
 * BEHAVIOR:
 * 1. submit() returns Future immediately
 * 2. Main thread continues (non-blocking)
 * 3. isDone() = false initially
 * 4. get(2s) â†’ TimeoutException (task takes 7.8s)
 * 5. After timeout, task STILL running in background
 * 6. Final isDone() = true (task completed)
 * 
 * USE CASES: Fire-and-forget tasks, timeout control, result checking
 * =============================================================================
 */

import java.util.concurrent.*;

//FutureDemo
public class Main {
    public static void main(String[] args) {
        ThreadPoolExecutor poolExecutor = new ThreadPoolExecutor(
            1, 1, 1, TimeUnit.HOURS,
            new ArrayBlockingQueue<>(10),
            Executors.defaultThreadFactory(),
            new ThreadPoolExecutor.AbortPolicy()
        );

        // Submit async task â†’ returns Future IMMEDIATELY
        Future<?> futureObj = poolExecutor.submit(() -> {
            try {
                System.out.println("ğŸš€ Task started by: " + Thread.currentThread().getName());
                Thread.sleep(7800);  // 7.8 seconds work
                System.out.println("âœ… Task COMPLETED");
            } catch (Exception e) {
                System.out.println("âŒ Task failed: " + e.getMessage());
            }
        });

        System.out.println("ğŸ“¤ Task submitted. Main continues...");
        System.out.println("â³ isDone: " + futureObj.isDone());  // false

        // Try to get result with 2-second timeout
        try {
            System.out.println("â±ï¸  Waiting 2s for result...");
            futureObj.get(2, TimeUnit.SECONDS);  // TIMEOUT!
            System.out.println("âœ… Result received");
        } catch (TimeoutException e) {
            System.out.println("â° TIMEOUT after 2s (task still running in background)");
        } catch (Exception e) {
            System.out.println("âŒ Other exception: " + e.getMessage());
        }

        // Check final state (task completes during timeout wait)
        System.out.println("ğŸ” Final state:");
        System.out.println("   isDone: " + futureObj.isDone());      // false
        System.out.println("   isCancelled: " + futureObj.isCancelled()); // false
        
        try{
            System.out.println("Blocking call to wait for result: "+futureObj.get());
        } catch(Exception e) {
            System.out.println("Exception occured at Blocking call: " + e.getMessage());
        }

        poolExecutor.shutdown();
        System.out.println("ğŸ Demo complete");
    }
}

/**
 * OUTPUT:
    ğŸ“¤ Task submitted. Main continues...
    â³ isDone: false
    ğŸš€ Task started by: pool-1-thread-1
    â±ï¸  Waiting 2s for result...
    â° TIMEOUT after 2s (task still running in background)
    ğŸ” Final state:
       isDone: false
       isCancelled: false
    âœ… Task COMPLETED
    Blocking call to wait for result: null
    ğŸ Demo complete
*/
